Подача объявления как сейчас, метка Телефон меняется на Номер мобильного телефона	*

После нажатия на Добавить, если все ок, переходим на страницу На номер **** *** *** отправлен код. Введите его.

После верного ввода редиректим на туда где и сейчас.

При поднятии, если номер не верифицирован, к каптче добавляется поле ввести код из смс.

------------------
Исходя из того что есть.
При подаче объявления смс код обязателен.
Поэтому для каждого записи в main сразу генерим код и сразу же его отправляем в смс.
Если такой код введен верно, то в users пишем verify = 1 для данного тел. номера.

При поднятии если не верифи - то код генерим туда же, где и при подаче, сравниваем, прочее соответственно.

В обоих случаях коды генерим в отдельной табличке, main_id - уникальный ключ, при дублировании обновляем.
При успешной авторизации - удаляем запись.

Если подает авторизованый, то смс не надо.

Какие поля нужны в main в связи с внедрением смс?
 не забыть про интервал две минуты между запросами.








Верстка.

Помнить, что все страницы должны быть рабочими с экрана смартфона, сейчас это так, надо чтобы и дальше было так.

Сохранить себе на диск страницу поднятия объявлений, страницу при сохранении назвать как-нибудь очень коротко, например 1.html

(Чтобы увидеть страницу поднятия объявлений, подать объявление на сайте gazel.me указав пароль и мыло, после чего авторизоваться и нажать
на ссылку (кнопку) "поднять").


Это будет страничка 01.html

Добавить на эту страничку заметное сообщение, "У вас осталось 100 бесплатных поднятий объявлений"


Создать новую страничку (02)

У пользователя 0 поднятий, формы для ввода капчи нет

он видит сообщение: 

Поднятие одного объявления стоит 1 рубль

Приобрести можно от 10 до 300 поднятий.


Кнопка Продолжить?

Создать новую страничку (03)

Видим логотипы большой тройки операторов (МТС, Билайн, Мегафон), также логотипы яндекс денег и вебмани

Перед добавлением проверь, позволяют ли Билайн и Мегафон переводить со счета на счет и выводить со счета на карту или ещё как.
МТС проверен.


Для каждой ссылки добавляем страницу 04_система, то есть например (04_mts.html, 04_beeline.html).

На этих страницах видим краткую инструкцию, что и куда надо отправить (например смс номер сумма на номер такой-то для МТС).


Добавить ссылку (ссылки) на страницу (страницы) соотв. сайта, где описаны условия перевод со счета на счет.

Например для МТС можно две ссылки: на страницу с описанием  этой услуги и на pdf документ с подробным описанием (есть у них на сайте).


Для яндекс денег и вебманей просто текущую коммиссию за перевод от абонента на номер абонента, в верстке можно от балды цифру указать.



Также хорошо бы сакцентировать внимание пользователя, что выгоднее один раз оплатить 100 рублей чем 100 раз по 1-му
потому что за перевод  берется коммиссия. В принципе вещь очевидная, но не помешает, но надо ненавязчиво. 
Короче если сложно, с этим моментом не заморачивайся.
=======
License
Соц сети.


добавить проверку на наличие сайта в тексте																		*

Вариант с флагом со стороны js в контроллерах обрабатывается ошибочно.											*
Проверка должна быть не только для текста объявления, но еще для заголовка и телефона.							*
Алгоритм проверки на телефон в тексте.																			*
 разбить по словам
 из каждого удалить все не цифры
 если более 4 цифр в слове - нужно модерировать вручную.
 если подрят идут более двух слов состоящих из цифр - нужно модерировать вручную.

JS проверяет этим алгоритмом, если найдено, отправляет флаг need moderate										*
ЗЗЗ PHP при подаче объявления если видит флаг nm и он равен 1 - сразу помечает как модерируемое вручную 		*
 (как сейчас) иначе - запускает алгоритм и см ЗЗЗ.
 
 насчет редактирования - не забыть																				*
 
Как пометить объявление как автоматически модерируемое.															*
 Добавить поле в базу automoderate по умолчанию 0.
 Если объявление прошло проверку автоматом - ставим его в 1.
 
 Дать объявление с телефоном в тексте - am должно быть равно 0													*
 Дать объявление без телефона в тексте - am должно быть равно 1													*
 
 
Добавить админ - страницу, на которой показываются опубликованые объявления с automoderate = 1.					*
Кнопки Удалить, Публиковать - последняя снимает automoderate - по сути копия страницы модерации 
	так как тоже ставит is_moderate = 1.

Страница модерации - добавить снятие флага automoderate при публикации.											*

Скрипт js запрашивает воркер. Воркер берет автомодерированые лежащие более 15 минут и ставит их модерироваными. *
 Флаг is_moderate при этом изменяется, флаг automoderate - нет.
 Проверить, как там себя на сервере ведет поле created, если неправильно, пусть оно ставится скриптом.


В модераторской показывать автоматику синим																		*

Добавить пункт в меню																							*

При админлогине редиректить на private/autoadv																	*

Отключение автомодерации из конфига																				*




Баги
Нельзя подать объявление без картинки. На сервере - работает вроде.... проверить на локалке для термобудки     *



Пишем тест платных объявлений.

На той странице, что есть сейчас для поднятия объявлений

Пользователь видит сообщение, "У вас осталось 100 бесплатных поднятий объявлений"

Когда видит 0, видит сообщение 

Поднятие одного объявления стоит 1 рубль

Приобрести можно от 10 до 300 поднятий.

Кнопка Продолжить?     /считаем количество нажатий

Видим логотипы большой тройки операторов

Выбираем нужную.     //считаем количество нажатий на логотипы

Видим инструкцию, что и куда надо отправить (например смс номер сумма на номер такой-то для МТС)



next stop


http://ipgeobase.ru/cgi-bin/AdvSearch.cgi?country=RU&city=&region=&district=&adv_srch_sbmt=%C8%F1%EA%E0%F2%FC&action_type=adv_search

217.66.156.16 Спб
78.109.16.152 - 78.109.16.159 - Москва
91.235.169.0 - 91.235.169.255 - Нижний
109.70.184.0 - 109.70.187.255 - Махачкала
194.105.197.0 - 194.105.197.127 - Выборг
176.115.136.0 - 176.115.143.255 - Кизляр

надо подумать вообще
заходит чел, если страница главная и ua+ip не перенаправлялся в течении часа, и удалость определить регион - редирект на регион

завтра начну потихоньку пилить локации



Релиз в октябре
 

При релизе 
не забыть удалить тестовый ip из index.php

Выполнить на продакте                     *
 geoip.sql


тщательно проверить, что там с датами.

Искать в истории по #geoip


router.php
index.php

lib/functions.php							*
lib/geoip.php								*
SxG*/*										*
lib/request_patcher							*


